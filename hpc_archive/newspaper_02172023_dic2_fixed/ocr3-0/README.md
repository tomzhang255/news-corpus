Batch compute all documents

- only outer-most layer has parallel pool
- inner layer has two for-loops with no parallel pool
